{% set pagetitle = 'Enter your username and password'|trans %}

{% extends "@core/base.twig" %}

{% block postload %}
	{{js_block}}
{% endblock %}

{% block content %}

{% for warning in warning_messages -%}
	<div class="pure-g">
		<div class="pure-u-1">
			<div class="message-box error">
				<h3>{{ login:error_header | trans }}</h3>

				<p>
					{{ warning}}
				</p>
			</div>
		</div>
	</div>
{% endfor %}

<h2 id="authHeaderTitle">{{ notakey:notakey:login_header | trans }}</h2>
<p class="logintext">{{  | trans }}</p>
<div id="authContent">
	<?php
if(!$this->data['state']['notakey:stageOneComplete']){
?>
		<div id="loginTableView">
			<form action="/<?php echo $this->data['baseurlpath']; ?>module/notakey/auth" id="loginForm" method="post">
				<div id="loginForm">

					<div id="spLoginLogo">
						<img alt="<?php echo htmlspecialchars($this->data['service']['name']); ?> logo" src="<?php echo $this->data['service']['service_logo']; ?>"/>
					</div>

					<div
						class="loginFormUsername">
						<!--  <?php echo $this->t('{notakey:notakey:please_enter_username}') ?> -->
						<input type="text" value="<?php echo isset($this->data['username_hint'])?htmlspecialchars($this->data['username_hint']):''; ?>" name="username" id="username" placeholder="<?php echo $this->t('{login:username}'); ?>" tabindex="1" maxlength="100">
					</div>
					<?php
                if ($this->data['rememberMeEnabled']) {
                // display the remember me checkbox (keep me logged in)
                ?>
					<div class="loginFormRememberMe">
						<inputdata['rememberMeChecked']) type="checkbox" id="remember_me" tabindex="3" <?php echo ($this-> ? 'checked="checked"' : '' ; ?>
							name="remember_me" value="Yes"/>
							<small><?php echo $this->t('{login:remember_me}'); ?></small>
						</div>
					<?php
                }
                ?>
					<div class="regularSubmit">
						<input type="button" id="regularsubmit" tabindex="4" value="<?php echo $this->t('{login:login_button}'); ?>" onclick=" this.value='<?php echo $this->t('{login:processing}'); ?>'; <?php if(!$this->data['mobile']){ echo 'cancelQrQuery();'; } ?> this.disabled=true; this.form.submit(); return true;"/>
					</div>
					<div class="mobileSubmit">
						<input type="button" tabindex="4" id="mobilesubmit" value="<?php echo $this->t('{login:login_button}'); ?>" onclick=" this.value='<?php echo $this->t('{login:processing}'); ?>'; <?php if(!$this->data['mobile']){ echo 'cancelQrQuery();'; } ?> this.disabled=true; this.form.submit(); return true;"/>
					</div>
					<input type="hidden" name="service_id" value="0"/>
					<input type="hidden" name="ReturnTo" value="<?php echo htmlspecialchars($this->data['return_to']); ?>">
					<input type="hidden" name="State" value="<?php echo htmlspecialchars($this->data['state_id']); ?>">
				</div>
				<?php if($this->data['service'] && !$this->data['mobile']){ ?>
					<div id="qrCodeView">
						<img alt="Authentication QR code" src="<?php echo $this->data['qr_link']; ?>" height="300" width="300"/>
					</div>
					<?php echo $this->data['js_qr_check']; ?>
				<?php } ?>
			</form>
		</div>

	</div>
<?php
}else{
?>
	<div style="clear:both;"></div>
	<div class="control-group ">
		<div id="spLoginLogo">
			<img alt="<?php echo htmlspecialchars($this->data['service']['name']); ?> logo" src="<?php echo $this->data['service']['service_logo']; ?>"/>
		</div>
		<div class="clearfix"></div>
		<div class="control-group">
			<div class="float-l" id="progressind">
				<img height="40" src="/<?php echo $this->data['baseurlpath']; ?>module/notakey/resources/loading.gif" width="40">
			</div>
			<div class="float-l" id="progresstxt" style="max-width: 30rem;">
				<?php echo $this->t('{notakey:notakey:please_proceed_on_mobile}') ?>
			</div>
		</div>
		<div class="clearfix"></div>
	</div>
<?php
}












  
  {% endblock %}
